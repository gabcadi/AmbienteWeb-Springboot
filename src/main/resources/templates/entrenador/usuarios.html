<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
    <head th:replace="~{layout/components :: head}"></head>
    <head>
        <title>Usuarios - Admin | DC-PLINA</title>
        <link rel="stylesheet" th:href="@{/css/styles.css}"/>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
    </head>
    <body>
        <header th:replace="~{layout/components :: preHeader}"></header>
        <navbar th:replace="~{layout/components :: navbarAdministrador}"></navbar>


        <div class="w-100 p-4">
            <h1 class='my-3'>Módulo de Usuarios</h1>
            <div class="mb-3">
                <button class="btn btn-danger" data-toggle="modal" data-target="#usuarioModal">Crear Nuevo Usuario</button>
            </div>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Username</th>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Teléfono</th>
                        <th>Email</th>
                        <th>Activo</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="usuario : ${usuarios}">
                        <td th:text="${usuario.username}"></td>
                        <td th:text="${usuario.nombre}"></td>
                        <td th:text="${usuario.apellido}"></td>
                        <td th:text="${usuario.telefono}"></td>
                        <td th:text="${usuario.email}"></td>
                        <td th:text="${usuario.activo ? 'Sí' : 'No'}"></td>
                        <td>
                            <button class="btn btn-info" th:onclick="'window.location.href=\'/usuarios/editar/' + ${usuario.idUsuario} + '\''">Editar</button>
                            <button class="btn btn-danger" th:onclick="'window.location.href=\'/usuarios/eliminar/' + ${usuario.idUsuario} + '\''">Eliminar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="modal fade" id="usuarioModal" tabindex="-1" role="dialog" aria-labelledby="usuarioModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="usuarioModalLabel">Crear Nuevo Usuario</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="usuarioForm" th:action="@{/usuarios/guardar}" th:object="${usuario}" method="post">
                            <div class="form-group">
                                <label for="nombre">Nombre:</label>
                                <input type="text" id="nombre" class="form-control" required/>
                            </div>
                            <div class="form-group">
                                <label for="apellido">Apellido:</label>
                                <input type="text" id="apellido" class="form-control" required/>
                            </div>
                            <div class="form-group">
                                <label for="telefono">Teléfono:</label>
                                <input type="text" id="telefono" class="form-control" required/>
                            </div>
                            <div class="form-group">
                                <label for="username">Username:</label>
                                <input type="text" id="username" class="form-control" required/>
                            </div>
                            <div class="form-group">
                                <label for="email">Email:</label>
                                <input type="email" id="email" class="form-control" required/>
                            </div>
                            <div class="form-group">
                                <label for="contrasena">Contraseña:</label>
                                <input type="password" id="contrasena" class="form-control" required/>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary" onclick="submitForm()">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
        
        <footer th:replace="~{layout/components :: footer}"></footer>
    </body>
    <script>
    function submitForm() {
        document.getElementById('usuarioForm').submit();
    }
    </script>
</html>
